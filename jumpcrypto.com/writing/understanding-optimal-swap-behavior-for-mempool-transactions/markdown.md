[](/)

  * Building 
    * [Firedancer](/firedancer/)
    * [the Pit](/thepit/)
    * [Cyclone](/cyclone/)
  * Thinking 
    * [Writing](/writing/)
    * [Research](/research/)
  * [Connect](/connect/)

  * [Building](/)
    * [Firedancer](/firedancer/)
    * [the Pit](/thepit/)
    * [Cyclone](/cyclone/)
    * [Collaborations](/collaborations/)
  * [Thinking](/writing/)
    * [Writing](/writing/)
    * [Research](/research/)
    * [Media](/media/)
  * [About](/writing/)
    * [Chronicle](/chronicle/)
    * [Validator](/validator-security/)
    * [Brand & Press](/brand/)
    * [Connect](/connect/)

[](https://twitter.com/jump_)[](https://github.com/JumpCrypto)[](https://www.youtube.com/@jump_)

[Terms of Use_](/terms-of-use/)[Privacy Policy_](/data-protection-and-privacy-
policy/)[Disclaimers_](/nfa/)

![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM2NSIgaGVpZ2h0PSI3MTEiIHZpZXdCb3g9IjAgMCAxMzY1IDcxMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgb3BhY2l0eT0iMC4zIj4KPHJlY3QgeT0iOTIuNzM5MSIgd2lkdGg9IjE0Mi45NzMiIGhlaWdodD0iNjEuODI2MSIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSIxNzMuODg2IiB5PSIyNzguMjE4IiB3aWR0aD0iNDYzLjY5NiIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxwYXRoIGQ9Ik0xNzMuODg2IDM3MC45NTZINDQwLjUxMVY0MzIuNzgySDE3My44ODZWMzcwLjk1NloiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iMTczLjg4NiIgeT0iNDYzLjY5NiIgd2lkdGg9IjM3OC42ODUiIGhlaWdodD0iNjEuODI2MSIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSIxNzMuODg2IiB5PSI5Mi43MzkxIiB3aWR0aD0iNDg2Ljg4IiBoZWlnaHQ9IjYxLjgyNjEiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iNjY3LjI2IiB5PSIyNzguNDkyIiB3aWR0aD0iNDA1LjczNCIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxyZWN0IHg9IjQ3MS40MjUiIHk9IjM3MC45NTYiIHdpZHRoPSI1MTAuMDY1IiBoZWlnaHQ9IjYxLjgyNjEiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iMTAxMi40IiB5PSIzNzAuOTU2IiB3aWR0aD0iMjgyLjA4MiIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxyZWN0IHg9IjkyLjczOTMiIHk9IjE4NS40NzgiIHdpZHRoPSI0MDUuNzM0IiBoZWlnaHQ9IjYxLjgyNjEiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iOTIuNzM5MyIgeT0iNTU2LjQzNSIgd2lkdGg9IjIzOS41NzYiIGhlaWdodD0iNjEuODI2MSIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSI1ODMuNDgzIiB5PSI0NjMuNjk2IiB3aWR0aD0iMjg1Ljk0NiIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxyZWN0IHg9IjkwMC44MDIiIHk9IjQ2My42MzEiIHdpZHRoPSIxNjIuMjEzIiBoZWlnaHQ9IjYyLjEyNDIiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iNjkxLjY4MSIgeT0iOTIuNzM5MSIgd2lkdGg9IjI5Ny41MzgiIGhlaWdodD0iNjEuODI2MSIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSI1OTguOTQiIHk9IjE4NS40NzgiIHdpZHRoPSIyOTcuNTM4IiBoZWlnaHQ9IjYxLjgyNjEiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iMTAyMC40NSIgeT0iOTMuMTg2MyIgd2lkdGg9IjI3My44MDciIGhlaWdodD0iNjAuOTczOCIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSI5OTYuOTQ2IiB5PSIxODUuNDc4IiB3aWR0aD0iMjk3LjUzOCIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxyZWN0IHg9IjEwOTMuNzkiIHk9IjQ2My4xNDQiIHdpZHRoPSIzOC42NDEzIiBoZWlnaHQ9IjYxLjgyNjEiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3QgeD0iNTI5LjM4NiIgeT0iMTg1LjQ3OCIgd2lkdGg9IjM4LjY0MTMiIGhlaWdodD0iNjEuODI2MSIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSI5MjcuMzkxIiB5PSIxODUuNDc4IiB3aWR0aD0iMzguNjQxMyIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxyZWN0IHg9IjEzMjUuNCIgeT0iMTg1LjQ3OCIgd2lkdGg9IjM4LjY0MTMiIGhlaWdodD0iNjEuODI2MSIgZmlsbD0iIzBFMjE0NyIvPgo8cmVjdCB4PSIzNjMuMjI4IiB5PSI1NTYuNDM1IiB3aWR0aD0iMzguNjQxMyIgaGVpZ2h0PSI2MS44MjYxIiBmaWxsPSIjMEUyMTQ3Ii8+CjxyZWN0IHk9IjY0OS4xNzQiIHdpZHRoPSIzOC42NDEzIiBoZWlnaHQ9IjYxLjgyNjEiIGZpbGw9IiMwRTIxNDciLz4KPHJlY3Qgd2lkdGg9IjE0MyIgaGVpZ2h0PSI2MiIgZmlsbD0iIzBFMjE0NyIvPgo8L2c+Cjwvc3ZnPgo=)

# Understanding Optimal Swap Behavior for Mempool Transactions

![Lucas Baker](https://jumpcrypto-
com.ghost.io/content/images/2023/01/avarat-5.png)

###### Lucas Baker

![Nihar Shah](https://jumpcrypto-
com.ghost.io/content/images/2023/01/avarat-6.png)

###### Nihar Shah

![Alex Toberoff](https://jumpcrypto-
com.ghost.io/content/images/2023/05/toberoff.jpg)

###### Alex Toberoff

![Suraj Srinivasan](https://jumpcrypto-
com.ghost.io/content/images/2023/05/headshot.jpg)

###### Suraj Srinivasan

[Economics](/writing/economics/)

May 23 2023 _ 3 min read

![Understanding Optimal Swap Behavior for Mempool
Transactions](https://jumpcrypto-
com.ghost.io/content/images/2023/05/Understanding_Optimal_Swap_Behavior_Blog.png)

Decentralized exchanges (DEXs) are one of the core foundations of DeFi,
facilitating [billions](https://defillama.com/dexs?ref=jumpcrypto.com) of
dollars in daily transactions. One would expect that such a critical and
battle-tested component of the ecosystem would be subject to intense
optimization pressure, and many aspects of the “transaction supply chain” have
indeed been optimized, from DEX
[aggregators](https://www.theblock.co/data/decentralized-finance/dex-non-
custodial?ref=jumpcrypto.com) that route trades across pools to
[gasless](https://www.matcha.xyz/?ref=jumpcrypto.com) swaps.

The protocol level is also rich with innovative designs, including
[RFQ](https://www.hashflow.com/?ref=jumpcrypto.com) platforms, private
[relay](https://bloxroute.com/?ref=jumpcrypto.com) services, order flow
[auctions](https://frontier.tech/the-orderflow-auction-design-
space?ref=jumpcrypto.com) (OFAs), and even
[competing](https://collective.flashbots.net/t/mev-share-programmably-private-
orderflow-to-share-mev-with-users/1264?ref=jumpcrypto.com)
[tools](https://mevblocker.io/?ref=jumpcrypto.com) to recapture the value
created by transaction activity. However, surprisingly little analysis has
been devoted to examining the basic parameters that make those transactions
“vulnerable” in the first place.

“Sandwiching,” the practice of extracting value created by a swap or similar
operation by surrounding it with trades on the same assets, remains a major
issue for transactions submitted openly via the mempool. Researchers at
[Eigenphi](https://eigenphi.io/?ref=jumpcrypto.com) estimate sandwiches have
yielded over $8 million in 30-day profits on Ethereum alone, which constitutes
the bulk of all on-chain “maximal extractable value” or MEV.

![](https://jumpcrypto-
com.ghost.io/content/images/2023/05/eigenphi_performance_of_mev_types-1.png)Performance
of MEV Types. Source: EigenPhi

While it is certainly possible to make transactions private or otherwise
protect them from leaking value using the services outlined above, the
continuing prevalence of sandwiching indicates that most users have yet to
adopt them. In practice, the bulk of DeFi swaps are submitted directly via
protocol frontends using default execution parameters (such as 0.5% max
slippage on Uniswap). Whether this is due to unfamiliarity or a reluctance to
rely on third-party services, we believe it indicates a need for a simpler
solution. One such solution is intelligent trade structuring — optimizing both
the number of trades and per-trade parameters — which can be implemented
purely on DEX frontends with no additional trust assumptions or changes to
infrastructure.

Recent [work](https://arxiv.org/abs/2202.03762?ref=jumpcrypto.com) on game-
theoretic sandwich prevention illustrates how size-dependent slippage limits
can reduce anticipated losses for many Uniswap traders (some by an order of
magnitude or more). However, the broader design space requires answers to
three questions:

  * **Single-swap parameters:** How should a mempool trader set slippage limits to minimize expected losses on a single transaction?
  * ************************Optimal swap splitting:************************ Within a single pool, how should a mempool trader split a single large swap into multiple parts executed across sequential blocks?
  * **MEV-aware DEX routing:** Across multiple pools, how should a DEX aggregator account for MEV to minimize expected end-to-end losses?

In our recent [note](https://jumpcrypto.com/research/a-short-note-on-setting-
swap-parameters/?ref=jumpcrypto.com), we present a theoretical framework to
address the first and second questions, simplifying the problems to a set of
closed-form solutions. First, we show how to set parameters for a given trade
size to balance **expected losses from execution** (e.g. transaction failures
and gas costs) with **losses from extraction** such as sandwiching. Second, we
show that, given a concave value function where slippage increases with size
(e.g. constant-product DEXes such as Uniswap and Curve), the optimal solution
is to **split a large block trade into equally-sized trades across sequential
blocks** , with the exact size determined by the value function.

While the current piece is theoretical and preliminary, we welcome both
implementations of and extensions to our framework. Future work could include
extensions to smaller swaps, where per-trade gas constitutes a larger fraction
of wealth, and work that generalizes multi-block swaps to multiple pools. More
broadly, we encourage DeFi builders to approach swap market efficiency from
both sides, helping users express intelligent front-end defaults while
continuing to improve market design and architecture. As volumes increase,
applications mature, and adoption widens, it will become increasingly
important to give users the tools to transact efficiently no matter their
level of sophistication or experience with the nuts and bolts of crypto.

Share

![](/static/subscribe2-825809a798c6960f978785c6581f4afb.svg)

#### Stay up to date with the latest from Jump_

​

.Subscribe

#### More articles

![SAFU: Creating a Standard for Whitehats](https://jumpcrypto-
com.ghost.io/content/images/2022/10/Standards-for-Whitehats-Thread---
blog.png)SAFU: Creating a Standard for WhitehatsWhitehats and DeFi protocols
need a shared understanding of security policy. We propose the SAFU - Simple
Arrangement for Funding Upload - as a versatile and credible way to let
whitehats know what to...](/writing/safu-creating-a-standard-for-whitehats/)

Oct 24 2022 _ 17 min

Share

[![Huckleberry: IBC Event Hallucinations](https://jumpcrypto-
com.ghost.io/content/images/2023/09/New-Blog-Post.png)Huckleberry: IBC Event
HallucinationsThis blog post describes a vulnerability in ibc-go, the
reference implementation of the Interblockchain Communication Protocol (IBC)
used by most Cosmos blockchains](/writing/huckleberry-ibc-event-
hallucinations/)

Sep 06 2023 _ 4 min

Share

[![Mapping Markets: Evaluating Blockchain’s Mass Adoption
Potential](https://jumpcrypto-com.ghost.io/content/images/2023/06/Blog---
Mapping-Markets_-Evaluating-Blockchain-s-Mass-Adoption-Potential.png)Mapping
Markets: Evaluating Blockchain’s Mass Adoption PotentialIn this post, we
propose a geographically-oriented framework, which we call “Pueyo Maps”
(inspired by Tomas Pueyo’s geo-history), as a way of evaluating the long-term
suitability of blockchain-based s...](/writing/mapping-markets-blockchain-
mass-adoption-potential/)

Jun 05 2023 _ 20 min

Share

Disclaimer

The information on this website and on the Brick by Brick podcast or Ship Show
Twitter spaces is provided for informational, educational, and entertainment
purposes only.  This information is not intended to be and does not constitute
financial advice, investment advice, trading advice, or any other type of
advice.  You should not make any decision – financial, investment, trading or
otherwise – based on any of the information presented here without undertaking
your own due diligence and consulting with a financial adviser.  Trading,
including that of digital assets or cryptocurrency, has potential rewards as
well as potential risks involved. Trading may not be suitable for all
individuals. Recordings of podcast episodes or Twitter spaces events may be
used in the future.

![](data:image/svg+xml;charset=utf-8,%3Csvg height='619' width='1338'
xmlns='http://www.w3.org/2000/svg' version='1.1'%3E%3C/svg%3E)

![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAD0lEQVQoz2NgGAWjYBgCAALZAAHP5sSUAAAAAElFTkSuQmCC)![](/static/bb55dfe76137757a150d8db409a314e1/80e7e/brandLines.svg)

###### Building_

  * [Firedancer](/firedancer/)
  * [the Pit](/thepit/)
  * [Cyclone](/cyclone/)

###### Thinking_

  * [Writing](/writing/)
  * [Research](/research/)

###### About_

  * [Validator Security](/validator-security/)
  * [Connect](/connect/)

[Terms of Use_](/terms-of-use/)[Privacy Policy_](/data-protection-and-privacy-
policy/)[Disclaimers_](/nfa/)

© 2024 Jump Crypto. All Rights Reserved.

Jump Crypto does not operate any business lines that accept funds from
external investors. Any person, company, or app purporting to accept external
investor funds on behalf of Jump Crypto is fraudulent.

